!function(){function i(a,b){if(void 0===this||Object.getPrototypeOf(this)!==i.prototype)return new i(a,b);b=b||{},this.options={openedClass:b.openedClass||"opened",openedBodyClass:b.openedBodyClass||"popup-opened",closeBtnSelector:b.closeBtnSelector||".popup__close",targetPopupId:b.targetPopupId||a.data("popup-target"),eventsNameSpace:b.eventsNameSpace||"popup",closeOnBgClick:h(b.closeOnBgClick,!0),bodyFixedOnDesktop:h(b.bodyFixedOnDesktop,!0),closeOnEsc:h(b.closeOnEsc,!0),closeOnResize:h(b.closeOnResize,!1),beforeOpen:b.beforeOpen,afterOpen:b.afterOpen,beforeClose:b.beforeClose,afterClose:b.afterClose,remote:b.remote||a.data("popup-remote")},this.$button=a,this.$popup=$('[data-popup-id="'+this.options.targetPopupId+'"]'),this.defaultEvents="click."+this.options.eventsNameSpace+" tap."+this.options.eventsNameSpace,this.remoteData=this.options.remote?$.extend(!0,this.options.remote,{url:this.options.remote.url||a.data("popup-remote")}):this.options.remote,this.activate()}var a=$(window),b=$(document),c=$("body"),d=$("html, body"),e=!1,f=!1,g=function(){return window.matchMedia("(max-width: 1199px)").matches},h=function(a,b){return"boolean"==typeof a?a:b};i.prototype.checkAndCloseAllPopups=function(){var a=c.find("[data-popup-id]"),b=a.filter("."+this.options.openedClass);if(b.length){var d=b.data("popup");this.prevPopupScrollTop=d.scrollTop,d.close(!0)}return this},i.prototype.checkAndRunCallback=function(a){return"function"==typeof a?a.call(null,this):void 0!=a&&console.warn("Callback should be a function."),this},i.prototype.open=function(b){return b&&(this.actionsWithRemoteData(b),this.registerCloseBtnClick()),this.checkAndRunCallback(this.options.beforeOpen),(this.options.bodyFixedOnDesktop||g())&&(this.scrollTop=this.prevPopupScrollTop||a.scrollTop(),this.$popup.data("popupScrollTop",this.scrollTop),c.css("top",-this.scrollTop).addClass(this.options.openedBodyClass)),this.$popup.addClass(this.options.openedClass),this.checkAndRunCallback(this.options.afterOpen),this},i.prototype.close=function(a){return this.checkAndRunCallback(this.options.beforeClose),a||(c.removeAttr("style").removeClass(this.options.openedBodyClass),d.scrollTop(this.$popup.data("popupScrollTop")),this.prevScrollTop&&(this.prevScrollTop=!1)),this.$popup.removeClass(this.options.openedClass),this.checkAndRunCallback(this.options.afterClose),this},i.prototype.actionsWithRemoteData=function(a){if(a.replaces instanceof Array)for(var b=0,d=a.replaces.length;b<d;b++)$(a.replaces[b].what).replaceWith(a.replaces[b].data);if(a.append instanceof Array)for(b=0,d=a.append.length;b<d;b++)$(a.append[b].what).append(a.append[b].data);if(a.content instanceof Array)for(b=0,d=a.content.length;b<d;b++)$(a.content[b].what).html(a.content[b].data);a.js&&c.append(a.js),a.refresh&&window.location.reload(!0),a.redirect&&(window.location.href=a.redirect)},i.prototype.registerOpenOnClick=function(){var a=this;return this.$button.unbind(this.defaultEvents).on(this.defaultEvents,function(b){if(b.preventDefault(),a.checkAndCloseAllPopups(),a.remoteData){var c=a.remoteData;return $.ajax({cache:"false",method:"get",dataType:"json",url:c.url,data:c.data,beforeSend:c.onBeforeSend,complete:c.onComplete,success:a.open.bind(a),error:c.onError}),this}a.open(!1)}),this},i.prototype.registerCloseOnResize=function(){var b=this,d="resize."+this.options.eventsNameSpace;return e||(a.on(d,function(){!g()&&c.hasClass(b.options.openedBodyClass)&&i.closeAllPopups(b.options.openedClass)}),e=!0),this},i.prototype.registerCloseOnEsc=function(){var a=this,d="keyup."+this.options.eventsNameSpace;return f||(b.on(d,function(b){27==b.keyCode&&c.hasClass(a.options.openedBodyClass)&&i.closeAllPopups(a.options.openedClass)}),f=!0),this},i.prototype.registerCloseOnBgClick=function(){var a=this;return a.$popup.on(this.defaultEvents,function(b){b.target===a.$popup.get(0)&&a.close()}),this},i.prototype.registerCloseBtnClick=function(){var a=this,b=a.$popup.find(this.options.closeBtnSelector);return b.unbind&&b.on?(b.unbind(this.defaultEvents).on(this.defaultEvents,function(){a.close()}),this):(console.warn("Close button was not found"),this)},i.prototype.activate=function(){return this.$popup.data("popup")?(this.registerOpenOnClick(),this.$popup.data("popup",this),this):(this.registerCloseBtnClick(),this.$popup.data("popup",this),this.options.closeOnEsc&&this.registerCloseOnEsc(),this.options.closeOnBgClick&&this.registerCloseOnBgClick(),this.options.closeOnResize&&this.registerCloseOnResize(),this.registerOpenOnClick(),this)},i.prototype.kill=function(){this.$button.unbind(this.defaultEvents),this.$popup.data("popup",null)},i.kill=function(a){$(a).data("popup").kill()},i.closeAllPopups=function(a){a=a||"opened";var b=c.find("[data-popup-id]"),d=b.filter("."+a);if(d.length){var e=d.data("popup");e.close.call(e,!1)}},i.initialize=function(a,b){var c="[data-popup-target]";a=a||c;var d=a instanceof jQuery,e="string"==typeof a,f="object"==typeof a;return e||d||!f||(b=a,a=c),$(a).popup(b)},"object"==typeof module&&"object"==typeof module.exports?module.exports=i:"function"==typeof define&&define.amd?define("vintage-popup",function(){return i}):window.Popup=i,$.fn.popup=function(a){return this.each(function(){new i($(this),a)})}}();